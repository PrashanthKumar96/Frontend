import React, { useState, useEffect } from "react";
import { Chart } from "react-google-charts";
import axios from "axios";

export default function MonthlyPieChart() {
  const [monthData, setMonthData] = useState([]);
  const [selectedMonth, setSelectedMonth] = useState("1"); // Default to January

  useEffect(() => {
    // Fetch data for all months here
    axios
      .get("YOUR_ENDPOINT_URL_HERE")
      .then((response) => {
        setMonthData(response.data);
      })
      .catch((err) => console.log(err));
  }, []);

  const generateChartData = (selectedMonth) => {
    const monthIndex = parseInt(selectedMonth);
    const data = [["Category", "Value"]];
    const monthValues = monthData[monthIndex] || [];
    monthValues.forEach((value, index) => {
      data.push([`Category ${index + 1}`, value]);
    });
    return data;
  };

  return (
    <div>
      <h2>Monthly Expense Pie Chart</h2>
      <select onChange={(e) => setSelectedMonth(e.target.value)} value={selectedMonth}>
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3">March</option>
        <option value="4">April</option>
        <option value="5">May</option>
        <option value="6">June</option>
        <option value="7">July</option>
        <option value="8">August</option>
        <option value="9">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
      </select>
      <Chart
        chartType="PieChart"
        data={generateChartData(selectedMonth)}
        options={{
          title: `Monthly Expense Distribution for Month ${selectedMonth}`,
          is3D: true,
        }}
        width={"100%"}
        height={"400px"}
      />
    </div>
  );
}
