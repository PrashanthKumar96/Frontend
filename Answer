import React, { useEffect, useState } from "react";
import { Chart } from "react-google-charts";
import axios from "axios";

export const options = {
  title: "Data Analytics",
  is3D: true,
};

export default function Analytics() {
  const [categoryData, setCategoryData] = useState("");
  const [statusData, setStatusData] = useState("");
  const [selectedMonth, setSelectedMonth] = useState("1"); // Default to January
  const [statusChartData, setStatusChartData] = useState({});

  useEffect(() => {
    // Fetch data for category and status here
    axios
      .get("http://localhost:9091/expense/getByCategory")
      .then((response) => {
        setCategoryData(response.data);
      })
      .catch((err) => console.log(err));

    axios
      .get("http://localhost:9091/expense/getByStatus")
      .then((response) => {
        setStatusData(response.data);
      })
      .catch((err) => console.log(err));
  }, []);

  useEffect(() => {
    // Update statusChartData based on the selected month
    const monthData = statusData[selectedMonth] || [];
    const data = [["Task", "Numbers"]];
    data.push(...monthData.map((value, index) => [`Status ${index + 1}`, value]));
    setStatusChartData({ ...statusChartData, [selectedMonth]: data });
  }, [selectedMonth, statusData]);

  return (
    <div>
      <h2>Status Chart</h2>
      <select onChange={(e) => setSelectedMonth(e.target.value)} value={selectedMonth}>
        <option value="1">January</option>
        <option value="2">February</option>
        {/* Add options for other months (3 to 12) */}
      </select>
      <Chart
        chartType="PieChart"
        data={statusChartData[selectedMonth] || []}
        options={options}
        width={"100%"}
        height={"400px"}
      />
    </div>
  );
}
